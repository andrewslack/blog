<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: ruby, | Defending the Code]]></title>
  <link href="http://andrewslack.github.com/blog/categories/ruby-/atom.xml" rel="self"/>
  <link href="http://andrewslack.github.com/blog/"/>
  <updated>2013-04-04T14:04:01-06:00</updated>
  <id>http://andrewslack.github.com/blog/</id>
  <author>
    <name><![CDATA[Andrew M. Slack]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Up and Testing with Guard and Growl]]></title>
    <link href="http://andrewslack.github.com/blog/2013/04/04/up-and-testing-with-guard-and-growl/"/>
    <updated>2013-04-04T12:32:00-06:00</updated>
    <id>http://andrewslack.github.com/blog/2013/04/04/up-and-testing-with-guard-and-growl</id>
    <content type="html"><![CDATA[<p>Continuing on from my <a href="../../../02/08/up-and-testing-with-autotest-and-growl/">Autotest record</a> I thought it would be instructive to use <a href="https://github.com/guard">Guard</a> to achieve something equivalent.</p>

<p>Guard is defined as:</p>

<blockquote><p>a command line tool to easily handle events on file system modifications</p></blockquote>

<p>It supports a <a href="https://github.com/guard/guard/wiki/List-of-available-Guards">myriad of plugins</a>.  The one we are interested in is <a href="https://github.com/guard/guard-rspec">guard-rspec</a>.</p>

<p>So add this to your gemfile:
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[minimal gemfile] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>source "http://rubygems.org"&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>group :development  do
</span><span class='line'>  gem 'guard'
</span><span class='line'>  gem 'guard-rspec'
</span><span class='line'>  gem 'rb-fsevent'
</span><span class='line'>  gem "rspec", :require => "spec"
</span><span class='line'>  gem "growl"
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now create a Guardfile via
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[create initial Gaurdfile (filled with example definitions)] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ guard init rspec</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Edit it so that it looks something like this:
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[minimal Guardfile] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>notification :growl&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>guard 'rspec' do
</span><span class='line'>  watch(%r{&lt;sup>spec/.+_spec.rb$})&lt;/sup>
</span><span class='line'>  watch(%r{&lt;sup>lib/(.+).rb$})&lt;/sup>     { |m| "spec/lib/#{m[1]}_spec.rb" }
</span><span class='line'>  watch('spec/spec_helper.rb')  { "spec" }
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now create a spec folder (this is one of the places that are being 'watched').  So any changes in the specs (below spec/) or domain code (below lib/) will result in the guard firing (invoking rspec).</p>

<p>All we need to do now is run the guard
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[start guard] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ guard</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>The guard reads the GuardFile and monitors the resources.  Any changes in them i.e. the domain code or tests will invoke the rspec guard.  The results from which are pushed through the notification system, in this case Growl. For Growl to work make sure you have the correct version of growlnotify installed (<a href="http://growl.info/downloads#generaldownloads">download here</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Up and testing with Autotest and Growl]]></title>
    <link href="http://andrewslack.github.com/blog/2013/02/08/up-and-testing-with-autotest-and-growl/"/>
    <updated>2013-02-08T14:52:00-07:00</updated>
    <id>http://andrewslack.github.com/blog/2013/02/08/up-and-testing-with-autotest-and-growl</id>
    <content type="html"><![CDATA[<p>We know testing is great.  Write a test, run the test, make the test pass, refactor, rinse, repeat.  How about making automating the "run the test" step?</p>

<p>Yes, that would be great.</p>

<p>To get started add these items to your gemfile
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[gemfile] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem "autotest"
</span><span class='line'>gem "autotest-growl"
</span><span class='line'>gem "autotest-fsevent"&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;blockquote>&lt;p>bundle        # => to install these gems</span></code></pre></td></tr></table></div></figure></notextile></div></p></blockquote>

<p>autotest-fsevent monitors for file changes and engages autotest when it finds a file that has changed (the way it does it is far more efficient than polling the filesystem), autotest is the gem that runs the tests and autotest-growl notifies Growl (<a href="http://growl.info/">1</a>) the test results.</p>

<p>Our tests will be written in Rspec and for this to look good we should add some pleasant formatting options. To do that we add the following to the .rpsec file:
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[.rspec options] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>--color
</span><span class='line'>--format nested</span></code></pre></td></tr></table></div></figure></notextile></div>
For more options run rspec --help</p>

<p>When autotest fires up it looks for an .autotest settings file.  This file can be in the project folder and/or home folder, the former overrides the latter.  So for us we will drop our settings into a local .autotest
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[.autotest options] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>require "autotest/growl"            # =>  to interact with Growl
</span><span class='line'>require "autotest/fsevent"          # =>  to interact with filesystem events</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>That's all the config settings we need.  Now we start up autotest [-v] from the commandline.  Go change a test and see autotest engage and notify you thru Growl!</p>
]]></content>
  </entry>
  
</feed>
